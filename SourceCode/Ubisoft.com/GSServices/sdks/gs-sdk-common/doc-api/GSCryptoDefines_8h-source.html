<HTML>

<HEAD>
<TITLE>Ubi.com GameService SDK</TITLE>
<LINK href="./gs-sdk-doc.css" rel="stylesheet" type="text/css">
</HEAD>

<BODY >
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>GSCryptoDefines.h</h1><a href="GSCryptoDefines_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">//****************************************************************************</span>
00002 <span class="comment">//*   Author:  Guillaume Plante  gsdevelopers@ubisoft.com</span>
00003 <span class="comment">//*   Date:    2002-06-10 10:11:16</span>
00010 <span class="comment"></span><span class="comment">//****************************************************************************</span>
00011 
00012 <span class="preprocessor">#ifndef __GSCRYPTODEFINES_H__</span>
00013 <span class="preprocessor"></span><span class="preprocessor">#define __GSCRYPTODEFINES_H__</span>
00014 <span class="preprocessor"></span>
<a name="l00021"></a><a class="code" href="GSCryptoDefines_8h.html#a20">00021</a> <span class="keyword">enum</span> <a class="code" href="GSCryptoDefines_8h.html#a20">GSCRYPTO_HASH_ALGO</a> {
00022     E_MD5,
00023     E_SHA1
00024 };
00025 
<a name="l00026"></a><a class="code" href="GSCryptoDefines_8h.html#a0">00026</a> <span class="preprocessor">#define MD5_DIGESTSIZE  16      </span>
<a name="l00027"></a><a class="code" href="GSCryptoDefines_8h.html#a1">00027</a> <span class="preprocessor">#define SHA1_DIGESTSIZE 20      </span>
00028 <span class="preprocessor"></span>
<a name="l00029"></a><a class="code" href="GSCryptoDefines_8h.html#a2">00029</a> <span class="preprocessor"></span><span class="preprocessor">#define MD5_HEXASIZE    (2 * MD5_DIGESTSIZE)    </span>
<a name="l00030"></a><a class="code" href="GSCryptoDefines_8h.html#a3">00030</a> <span class="preprocessor">#define SHA1_HEXASIZE   (2 * SHA1_DIGESTSIZE)   </span>
00031 <span class="preprocessor"></span>
00032 <span class="preprocessor"></span>
<a name="l00039"></a><a class="code" href="GSCryptoDefines_8h.html#a21">00039</a> <span class="keyword">enum</span> <a class="code" href="GSCryptoDefines_8h.html#a21">GSCRYPTO_CIPHER_ALGO</a> {
00040     E_BLOWFISH,
00041     E_GSXOR
00042 };
00043 
<a name="l00050"></a><a class="code" href="GSCryptoDefines_8h.html#a22">00050</a> <span class="keyword">enum</span> <a class="code" href="GSCryptoDefines_8h.html#a22">GSCRYPTO_PKC_ALGO</a> {
00051     E_RSA
00052 };
00053 
<a name="l00060"></a><a class="code" href="GSCryptoDefines_8h.html#a23">00060</a> <span class="keyword">enum</span> <a class="code" href="GSCryptoDefines_8h.html#a23">GSCRYPTO_PRNG_ALGO</a> {
00061     E_MGF1
00062 };
00063 
<a name="l00064"></a><a class="code" href="GSCryptoDefines_8h.html#a4">00064</a> <span class="preprocessor">#define MGF1_HASHMULTIPLES              500    </span>
00065 <span class="preprocessor"></span>
00066 <span class="preprocessor"></span>
00068 
00069 
00070 <span class="comment">/* RSA key lengths.</span>
00071 <span class="comment"> */</span>
<a name="l00072"></a><a class="code" href="GSCryptoDefines_8h.html#a5">00072</a> <span class="preprocessor">#define MIN_RSA_MODULUS_BITS 508        </span>
<a name="l00073"></a><a class="code" href="GSCryptoDefines_8h.html#a6">00073</a> <span class="preprocessor">#define MAX_RSA_MODULUS_BITS 1024       </span>
<a name="l00074"></a><a class="code" href="GSCryptoDefines_8h.html#a7">00074</a> <span class="preprocessor">#define MAX_RSA_MODULUS_LEN ((MAX_RSA_MODULUS_BITS + 7) / 8) </span>
<a name="l00075"></a><a class="code" href="GSCryptoDefines_8h.html#a8">00075</a> <span class="preprocessor">#define MAX_RSA_PRIME_BITS ((MAX_RSA_MODULUS_BITS + 1) / 2) </span>
00076 <span class="preprocessor">#define MAX_RSA_PRIME_LEN ((MAX_RSA_PRIME_BITS + 7) / 8) </span>
00077 <span class="preprocessor"></span>
00078 <span class="comment">/* Maximum lengths of encoded and encrypted content, as a function of</span>
00079 <span class="comment">   content length len. Also, inverse functions.</span>
00080 <span class="comment"> */</span>
00081 <span class="preprocessor">#define ENCODED_CONTENT_LEN(len) (4*(len)/3 + 3)</span>
00082 <span class="preprocessor"></span><span class="preprocessor">#define ENCRYPTED_CONTENT_LEN(len) ENCODED_CONTENT_LEN ((len)+8)</span>
00083 <span class="preprocessor"></span><span class="preprocessor">#define DECODED_CONTENT_LEN(len) (3*(len)/4 + 1)</span>
00084 <span class="preprocessor"></span><span class="preprocessor">#define DECRYPTED_CONTENT_LEN(len) DECODED_CONTENT_LEN ((len)-1)</span>
00085 <span class="preprocessor"></span>
00086 
00087 
00088 <span class="comment">/* Random structure.</span>
00089 <span class="comment"> */</span>
00090 <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00091   GSuint  bytesNeeded;
00092   GSubyte state[16];
00093   GSuint  outputAvailable;
00094   GSubyte output[16];
00095 } RANDOM_STRUCT;
00096 
00097 <span class="comment">/* RSA public and private key.</span>
00098 <span class="comment"> */</span>
00099 <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00100   GSuint bits;                           <span class="comment">/* length in bits of modulus */</span>
00101   GSubyte modulus[<a class="code" href="GSCryptoDefines_8h.html#a7">MAX_RSA_MODULUS_LEN</a>];                    <span class="comment">/* modulus */</span>
00102   GSubyte exponent[<a class="code" href="GSCryptoDefines_8h.html#a7">MAX_RSA_MODULUS_LEN</a>];           <span class="comment">/* public exponent */</span>
00103 } RSA_PUBLIC_KEY;
00104 
00105 <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00106   GSuint bits;                           <span class="comment">/* length in bits of modulus */</span>
00107   GSubyte modulus[<a class="code" href="GSCryptoDefines_8h.html#a7">MAX_RSA_MODULUS_LEN</a>];                    <span class="comment">/* modulus */</span>
00108   GSubyte publicExponent[<a class="code" href="GSCryptoDefines_8h.html#a7">MAX_RSA_MODULUS_LEN</a>];     <span class="comment">/* public exponent */</span>
00109   GSubyte exponent[<a class="code" href="GSCryptoDefines_8h.html#a7">MAX_RSA_MODULUS_LEN</a>];          <span class="comment">/* private exponent */</span>
00110   GSubyte prime[2][MAX_RSA_PRIME_LEN];               <span class="comment">/* prime factors */</span>
00111   GSubyte primeExponent[2][MAX_RSA_PRIME_LEN];   <span class="comment">/* exponents for CRT */</span>
00112   GSubyte coefficient[MAX_RSA_PRIME_LEN];          <span class="comment">/* CRT coefficient */</span>
00113 } RSA_PRIVATE_KEY;
00114 
00115 <span class="comment">/* RSA prototype key.</span>
00116 <span class="comment"> */</span>
00117 <span class="keyword">typedef</span> <span class="keyword">struct </span>{
00118   GSuint bits;                           <span class="comment">/* length in bits of modulus */</span>
00119   GSint useFormat4;                        <span class="comment">/* public exponent (1 = F4, 0 = 3) */</span>
00120 } RSA_PROTO_KEY;
00121 
00123 
00124 <span class="preprocessor">#endif // __GSCRYPTODEFINES_H__</span>
</pre></div><hr>
<p align="right">
<i>Ubi.com GameService SDK - &copy;UbiSoft Entertainment 2002 </i><br>
<i><a href="mailto:gsdevteam@ubisoft.com">GameService development team</a></i>
</p>
</body>
</html>
