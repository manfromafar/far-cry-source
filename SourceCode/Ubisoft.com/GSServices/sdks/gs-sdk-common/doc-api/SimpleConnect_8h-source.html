<HTML>

<HEAD>
<TITLE>Ubi.com GameService SDK</TITLE>
<LINK href="./gs-sdk-doc.css" rel="stylesheet" type="text/css">
</HEAD>

<BODY >
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>SimpleConnect.h</h1><div class="fragment"><pre>00001 <span class="preprocessor">#ifndef _GSSIMPLECONNECT_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _GSSIMPLECONNECT_H</span>
00003 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="define_8h.html">define.h</a>"</span>
00004 
00005 <span class="keyword">class </span>clGSConnect;
00006 <span class="keyword">class </span>clConnectElem;
00007 <span class="keyword">class </span>clConnectList;
00008 <span class="keyword">class </span>clTCPClient;
00009 <span class="keyword">class </span>clUNIXClient;
00010 
00011 <span class="comment">//===================================================================================================</span>
00012 <span class="keyword">class </span>clSimpleClient
00013 {
00014 <span class="keyword">private</span>:
00015         clConnectElem* m_pstConnectElem;
00016         GSchar m_szAddress[129];
00017 
00018 <span class="keyword">public</span>:
00019     <span class="comment">/* Constructor/Destructor */</span>
00020     clSimpleClient( GSint lAliveDuring, GSint lRcvTimeout,
00021                     GSint iUDPSndBuf = 0, GSint iUDPRcvBuf = 0);
00022     ~clSimpleClient();
00023   
00024     <span class="comment">/* To connect on a peer address using TCP */</span>
00025     GSbool ConnectHost(GSchar *szHost, GSushort lPort);
00026 
00027 <span class="preprocessor">#ifdef LINUX</span>
00028 <span class="preprocessor"></span>        <span class="comment">/* To connect to a peer UNIX process */</span>
00029         GSbool ConnectUNIXHost(GSchar *sSockPipe);
00030 <span class="preprocessor">#endif // LINUX</span>
00031 <span class="preprocessor"></span>
00032     <span class="comment">/* Disconnect from peer address */</span>
00033     GSbool Disconnect(GSvoid);
00034 
00035     <span class="comment">/* Update messages receive/send */</span>
00036     GSbool CheckConnection(GSvoid);
00037   
00038         <span class="comment">/* To send a message (put in the send queue) (Priority : 0-31) */</span>
00039         GSbool SendGuaranteed( GSubyte ucType, GSubyte ucPriority, GSvoid *pvMessage, GSint lMsgSize);
00040         GSbool SendLostable( GSubyte ucType, GSubyte ucPriority, GSvoid *pvMessage, GSint lMsgSize);
00041 
00042         <span class="comment">/* To read a message (from the received queue) */</span>
00043     GSvoid* ReadGuaranteed( GSubyte&amp; rucType, GSint&amp; rlSize);
00044     GSvoid* ReadLostable( GSubyte&amp; rucType, GSint&amp; rlSize);
00045 
00046         <span class="comment">/* IP management */</span>
00047     GSchar* GetPeerIPAddress(GSvoid);
00048         GSchar* GetLocalIPAddress(GSvoid);
00049         
00050         <span class="comment">// Checks to see if the UDP connection has been established.</span>
00051         <span class="comment">// You must call CheckConnection, ReadGuaranteed and ReadLostable</span>
00052         <span class="comment">// between calls to IsUDPConnected to generate and send internal messages</span>
00053         <span class="comment">// that establish the UDP connection</span>
00054         GSbool IsUDPConnected();
00055 };
00056 
00057 <span class="comment">//===================================================================================================</span>
00058 <span class="keyword">class </span>clSimpleServer
00059 {
00060 <span class="keyword">private</span>:
00061     clConnectList* m_pstConnectList;
00062 
00063     GSint  m_lConnectedMode;
00064     GSint  m_lStillAliveDuring;
00065     GSint  m_lRcvDuring;
00066     GSchar  m_szAddress[129];
00067     
00068 <span class="keyword">public</span>:
00069     clSimpleServer( GSint lAliveDuring, GSint lRcvTimeout,
00070                     GSint iUDPSndBuf = 0, GSint iUDPRcvBuf = 0);
00071     ~clSimpleServer();
00072     
00073     <span class="comment">/* Return the port reserved */</span>
00074     GSbool ReservePort(GSushort lPort);
00075     
00076 <span class="preprocessor">#ifdef LINUX</span>
00077 <span class="preprocessor"></span>    <span class="comment">/* Puts the UNIX server into listening mode (UNIX Sockets) */</span>
00078     GSbool OpenSocket(GSchar *p_strSockPipe);
00079 <span class="preprocessor">#endif // LINUX</span>
00080 <span class="preprocessor"></span>    
00081     <span class="comment">/* Return the ID of the new connection */</span>
00082     GSint AcceptConnection(GSvoid);
00083     
00084     <span class="comment">/* Return the ID of the element disconnected */</span>
00085     GSint CheckDisconnection(GSvoid);
00086 
00087     <span class="comment">/* To disconnect an element */</span>
00088     GSbool DisconnectElement(GSint lId);
00089 
00090         <span class="comment">/* To send a message (put in the send queue) (Priority : 0-31) */</span>
00091         GSbool SendGuaranteed( GSint lId, GSubyte ucType, GSubyte ucPriority, GSvoid *pvMessage, GSint lMsgSize);
00092         GSbool SendLostable( GSint lId, GSubyte ucType, GSubyte ucPriority, GSvoid *pvMessage, GSint lMsgSize);
00093         GSbool SendGuaranteedToAll( GSubyte ucType, GSubyte ucPriority, GSvoid *pvMessage, GSint lMsgSize);
00094         GSbool SendLostableToAll( GSubyte ucType, GSubyte ucPriority, GSvoid *pvMessage, GSint lMsgSize);
00095 
00096         <span class="comment">/* To read a message (from the received queue) */</span>
00097     GSvoid* ReadGuaranteed( GSint&amp; rlId, GSubyte&amp; rucType, GSint&amp; rlSize);
00098     GSvoid* ReadLostable( GSint&amp; rlId, GSubyte&amp; rucType, GSint&amp; rlSize);
00099 
00100         <span class="comment">/* IP management */</span>
00101     GSchar* GetPeerIPAddress(GSint lId);
00102                 
00103         <span class="comment">// Checks to see if the UDP connection has been established for that</span>
00104         <span class="comment">// connection ID.  You must call CheckDisconnection, ReadGuaranteed and</span>
00105         <span class="comment">// ReadLostable between calls to IsUDPConnected to generate and send internal</span>
00106         <span class="comment">// messages that establish the UDP connection</span>
00107                 GSbool IsUDPConnected(GSint iID);
00108 };
00109 
00110 <span class="preprocessor">#endif // _GSSIMPLECONNECT_H</span>
</pre></div><hr>
<p align="right">
<i>Ubi.com GameService SDK - &copy;UbiSoft Entertainment 2002 </i><br>
<i><a href="mailto:gsdevteam@ubisoft.com">GameService development team</a></i>
</p>
</body>
</html>
