<HTML>

<HEAD>
<TITLE>Ubi.com GameService SDK</TITLE>
<LINK href="./gs-sdk-doc.css" rel="stylesheet" type="text/css">
</HEAD>

<BODY >
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>RegServerLib.h</h1><div class="fragment"><pre>00001 <span class="comment">/***SDOC************************************************************************</span>
00002 <span class="comment"> *                                UbiSoft Network Development</span>
00003 <span class="comment"> *                                ---------------------------</span>
00004 <span class="comment"> *</span>
00005 <span class="comment"> * FILE........: RegServerLib.h</span>
00006 <span class="comment"> * CREATION....: Sept 2001</span>
00007 <span class="comment"> * AUTHOR......: Guillaume Plante</span>
00008 <span class="comment"> *</span>
00009 <span class="comment"> * DESCRIPTION.: Interface class to login fonctionality</span>
00010 <span class="comment"> *</span>
00011 <span class="comment"> *******************************************************************************</span>
00012 <span class="comment"> *                                         FILE HISTORY</span>
00013 <span class="comment"> *******************************************************************************</span>
00014 <span class="comment"> *</span>
00015 <span class="comment"> * DATE........:</span>
00016 <span class="comment"> * AUTHOR......:</span>
00017 <span class="comment"> * DESCRIPTION.:</span>
00018 <span class="comment"> *</span>
00019 <span class="comment"> ***********************************************************************EDOC***/</span>
00020 
00021 <span class="preprocessor">#ifndef __CLIENTLIB_H__</span>
00022 <span class="preprocessor"></span><span class="preprocessor">#define __CLIENTLIB_H__</span>
00023 <span class="preprocessor"></span>
00024 <span class="preprocessor">#include "define.h"</span>
00025 
00026 <span class="keyword">class </span>clDataList;
00027 <span class="keyword">class </span>clDataBin;
00028 <span class="keyword">class </span>clSRPGSClient;
00029 <span class="keyword">class </span>CRegServerConnection;
00030 <span class="keyword">class </span>clParentGroups;
00031 
00032 <span class="keyword">class </span>CRegisterServer
00033 {
00034         <span class="keyword">public</span>:
00035 
00036         CRegisterServer();
00037         <span class="keyword">virtual</span> ~CRegisterServer();
00038 
00039         <span class="comment">// RegServer public functions</span>
00040         <span class="keyword">public</span>:
00041         GSvoid <a class="code" href="group__LibraryFunctions.html#a2">RegServer_Engine</a>();
00042         GSbool <a class="code" href="group__RouterFunctions.html#a0">RegServerSend_RouterConnect</a>( <span class="keyword">const</span> GSchar* szAddress, GSint lPort );
00043         GSbool <a class="code" href="group__RouterFunctions.html#a2">RegServerSend_RouterDisconnect</a>();
00044         GSbool <a class="code" href="group__RouterFunctions.html#a1">RegServerSend_LoginRouter</a>( <span class="keyword">const</span> GSchar* szAlias,
00045                         <span class="keyword">const</span> GSchar* szPassword, <span class="keyword">const</span> GSchar* szVersion );
00046         GSbool <a class="code" href="group__RouterFunctions.html#a3">RegServerSend_RequestParentGroupOnLobby</a>( <span class="keyword">const</span> GSchar* szGameName );
00047 
00048         GSbool <a class="code" href="group__RouterFunctions.html#a4">RegServerSend_RegisterServerOnLobby</a>(
00049                         GSuint uiLobbyID,
00050                         GSint iParentID,
00051                         <span class="keyword">const</span> GSchar* szRoomName,
00052                         <span class="keyword">const</span> GSchar* szGameName,
00053                         GSushort uwRoomType,
00054                         GSuint uiMaxPlayer,
00055                         GSuint uiMaxSpectator,
00056                         <span class="keyword">const</span> GSchar* szPassword,
00057                         <span class="keyword">const</span> GSvoid* pstGroupInfo,
00058                         GSint iGroupInfoSize,                   
00059                         <span class="keyword">const</span> GSvoid* pstAltGroupInfo,
00060                         GSint iAltGroupInfoSize,                        
00061                         <span class="keyword">const</span> GSvoid* pstGameData,
00062                         GSint iGameDataSize,
00063                         GSushort usGamePort,
00064                         <span class="keyword">const</span> GSchar* szGameVersion,
00065                         <span class="keyword">const</span> GSchar* szGSVersion,
00066                         GSbool bScoreSubmission,
00067                         GSbool bDedicatedServer );
00068 
00069 
00071         <span class="comment">// Lobby Server</span>
00073 <span class="comment"></span>        GSbool <a class="code" href="group__LobbyServerFunctions.html#a0">RegServerSend_LobbyServerConnection</a>( <span class="keyword">const</span> GSchar* szAddress, GSushort usPort,
00074                         GSushort usLocalPort = 0, GSuint uiStillAliveDelay = 25, GSuint uiDisconnectionDelay = 120 );
00075         GSbool <a class="code" href="group__LobbyServerFunctions.html#a1">RegServerSend_LobbyServerClose</a>();
00076         GSbool <a class="code" href="group__LobbyServerFunctions.html#a2">RegServerSend_LobbyServerLogin</a>( <span class="keyword">const</span> GSchar* szAlias,GSint iGroupID );
00077         GSbool <a class="code" href="group__LobbyServerFunctions.html#a4">RegServerSend_LobbyServerMemberJoin</a>( <span class="keyword">const</span> GSchar* szMember );
00078         GSbool <a class="code" href="group__LobbyServerFunctions.html#a5">RegServerSend_LobbyServerMemberLeave</a>( <span class="keyword">const</span> GSchar* szMember );
00079         GSbool <a class="code" href="group__LobbyServerFunctions.html#a3">RegServerSend_UpdateGroupSettings</a>(
00080                         GSint iGroupID,
00081                         GSbyte bOpen,
00082                         GSbyte bScoreSubmission,
00083                         GSbyte bDedicatedServer,
00084                         GSint iMaxPlayers,
00085                         GSint iMaxSpectator,
00086                         <span class="keyword">const</span> GSchar* szPassword,
00087                         <span class="keyword">const</span> GSvoid* pucGroupInfo,
00088                         GSint iGroupInfoSize,
00089                         <span class="keyword">const</span> GSvoid* pucAltGroupInfo,
00090                         GSint iAltGroupInfoSize,
00091                         <span class="keyword">const</span> GSvoid* pucGameData,
00092                         GSint iGameDataSize,
00093                         GSushort usGamePort );
00094         
00095         GSbool <a class="code" href="group__LobbyServerFunctions.html#a6">RegServerSend_MatchStart</a>( GSuint uiMode = 0 );
00096         GSbool <a class="code" href="group__LobbyServerFunctions.html#a7">RegServerSend_MatchFinish</a>( );
00097 
00098         <span class="comment">//**************************************************</span>
00099         <span class="comment">//virtual Function used for the CallBack</span>
00100         <span class="comment">//**************************************************</span>
00101         <span class="keyword">virtual</span> GSvoid RegServerRcv_LoginRouterResult( GSubyte ucType, GSint lReason,
00102                         <span class="keyword">const</span> GSchar* szIPAddress ) = 0;
00103         <span class="keyword">virtual</span> GSvoid RegServerRcv_RouterDisconnection() = 0;
00104         <span class="keyword">virtual</span> GSvoid RegServerRcv_RegisterServerResult( GSubyte pucType,
00105                         GSint plReason,
00106                         GSint iGroupID,
00107                         <span class="keyword">const</span> GSchar* szAddress,
00108                         GSushort usPort,
00109                         <span class="keyword">const</span> GSchar* szSessionName ) = 0;
00110         <span class="keyword">virtual</span> GSvoid RegServerRcv_RequestParentGroupResult( GSubyte ucType,
00111                         GSint lReason, GSint iServerID,GSint iGroupID, <span class="keyword">const</span> GSchar* szGroupName,
00112                         GSuint uiNbPlayers, GSuint uiMaxPlayers ) = 0;
00113         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerLoginResults( GSubyte ucType,
00114                         GSint iReason, GSint iLobbyServerID, GSint iGroupID ) = 0;
00115         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerUpdateGroupSettingsResults(
00116                         GSubyte ucType, GSint iReason, GSint iGroupID ) = 0;
00117         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerDisconnection() = 0;
00118         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerMemberNew( <span class="keyword">const</span> GSchar* szMember,
00119                         GSbool bSpectator,
00120                 <span class="keyword">const</span> GSchar* szIPAddress, <span class="keyword">const</span> GSchar* szAltIPAddress,
00121                         <span class="keyword">const</span> GSvoid* pPlayerInfo, GSuint uiPlayerInfoSize,
00122                         GSushort usPlayerStatus ) = 0;
00123         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerMatchStartReply( GSubyte ucType,
00124                         GSint iReason, GSint iGroupID ) = 0;
00125         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerMemberLeft(<span class="keyword">const</span> GSchar* szMember ) = 0;
00126         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerMatchFinishReply( GSubyte ucType,
00127                         GSint iReason, GSint iGroupID ) = 0;
00128         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerGroupConfigUpdate(
00129                         GSuint uiGroupConfig, GSint iGroupID ) = 0;
00130         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerMemberUpdateStatus(
00131                         <span class="keyword">const</span> GSchar* szPlayer, GSushort usPlayerStatus ) = 0;
00132         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerNewGroup (GSushort usRoomType,
00133                 <span class="keyword">const</span> GSchar* szRoomName,
00134                 GSint iGroupID,
00135                 GSint iLobbyServerID,
00136                 GSint iParentGroupID,
00137                 GSint uiGroupConfig,
00138                 GSshort sGroupLevel,
00139                 <span class="keyword">const</span> GSchar* szMaster,
00140                 <span class="keyword">const</span> GSchar* szAllowedGames,
00141                 <span class="keyword">const</span> GSchar* szGame,
00142                 <span class="keyword">const</span> GSvoid* pGroupInfo,
00143                 GSuint GroupInfoSize,
00144                 GSuint uiMatchEventID,
00145                 GSuint uiMaxPlayers,
00146                 GSuint uiNbPlayers,
00147                 GSuint uiMaxSpectators,
00148                 GSuint uiNbSpectators,
00149                 <span class="keyword">const</span> GSchar* szGameVersion,
00150                 <span class="keyword">const</span> GSchar* szGSGameVersion,
00151                 <span class="keyword">const</span> GSchar* szIPAddress,
00152                 <span class="keyword">const</span> GSchar* szAltIPAddress ) = 0;
00153         <span class="keyword">virtual</span> GSvoid RegServerRcv_LobbyServerMemberUpdateInfo(
00154                         <span class="keyword">const</span> GSchar* szMember, <span class="keyword">const</span> GSvoid* pPlayerInfo,
00155                         GSuint uiPlayerInfoSize ) = 0;
00156 
00157         <span class="keyword">private</span>:
00158 
00159         GSvoid RegServer_UnInitRouterConnection();
00160         GSvoid RegServer_UnInitLobbyServerConnection();
00161         GSvoid CheckDisconnection();
00162 
00163         GSbool RegServerRcv_LoginRouterResult( GSushort SFType,clDataList* pDataList);
00164         GSbool RegServerRcv_RegisterServerResult( GSushort usFSType,
00165                         clDataList* pDataList );
00166         GSbool RegServerRcv_RequestParentGroupResult( GSushort SFType,
00167                         clDataList* pDataList );
00168 
00169         GSbool CheckLobbyServerConnection();
00170         GSbool ManageLobbyServerConnection();
00171         GSvoid CheckTheLobbyMessages();
00172         GSvoid ReadLobbySeverAnswer( GSubyte ucType, clDataList* pDataList );
00173         GSvoid RegServerRcv_LobbyServerLoginResults( GSuchar ucType,
00174                         clDataList* pDataMessage );
00175         GSvoid RegServerRcv_LobbyServerUpdateGroupSettingsResults( GSuchar ucType,
00176                         clDataList* pDataMessage );
00177         GSvoid RegServerRcv_LobbyServerNewMembers( clDataList* pDataMessage );
00178         GSvoid RegServerRcv_LobbyServerMatchStartReply( GSuchar ucType,
00179                         clDataList* pDataMessage );
00180         GSvoid RegServerRcv_LobbyServerMemberLeft( clDataList* pDataList );
00181         GSvoid RegServerRcv_LobbyServerMatchFinishReply( GSuchar ucType,
00182                         clDataList* pDataMessage );
00183         GSvoid RegServerRcv_LobbyServerGroupConfigUpdate( clDataList* pDataMessage );
00184         GSvoid RegServerRcv_LobbyServerMemberUpdateStatus( clDataList* pDataMessage );
00185         GSvoid RegServerRcv_LobbyServerNewGroup ( clDataList* pDataMessage );
00186         GSvoid RegServerRcv_LobbyServerMemberUpdateInfo(  clDataList* pDataMessage );
00187 
00188 
00189         clParentGroups *m_pParentGroups;
00190 
00191         GSchar m_szPlayerAlias[NICKNAMELENGTH];
00192         GSchar m_szAddress[IPADDRESSLENGTH];
00193         GSbool m_bServerRegistered;
00194 
00195         GSbool m_bLobbyConnected;
00196         GSbool m_bRouterConnected;
00197 
00198         GSchar m_szLocalIP[IPADDRESSLENGTH];
00199         CRegServerConnection* m_RouterConnection;
00200         clSRPGSClient* m_pSRPGSClient;
00201         GSint m_iLobbyServerID;
00202         GSint m_iGroupID;
00203 
00204 };
00205 
00206 <span class="preprocessor">#endif //__CLIENTLIB_H__</span>
</pre></div><hr>
<p align="right">
<i>Ubi.com GameService SDK - &copy;UbiSoft Entertainment 2002 </i><br>
<i><a href="mailto:gsdevteam@ubisoft.com">GameService development team</a></i>
</p>
</body>
</html>
